## ä½¿ç”¨redux-thunkå®ç°ajaxæ•°æ®è¯·æ±‚

ğŸŒŸèƒ½å¤Ÿå‘ç°åœ¨ä½¿ç”¨redux-thunkè¿‡ç¨‹ä¸­ä¸€å…±æ‰§è¡Œäº†ä¸¤æ¬¡dispatchå‡½æ•°ï¼š<br/>
<br/>ğŸ’ç¬¬ä¸€æ¬¡æ˜¯åœ¨todolist.jsä¸­ï¼Œå°†creator.jsä¸­const action=actions.getDataAction()é€šè¿‡dispatchå‘ç»™storeå¹¶è‡ªåŠ¨æ‰§è¡Œï½ï¼ï¼ï¼ğŸŒ¿ï¼›<br/>
<br/>ï¼ˆæ­£å¸¸æ¥è¯´action.jsä¸­çš„actionåˆ›å»ºå‡½æ•°éƒ½æ˜¯è¿”å›å¯¹è±¡çš„ï¼Œä½†æ˜¯actions.getDataActionå´æ˜¯è¿”å›å‡½æ•°ï¼Œå°±æ˜¯å› ä¸ºä½¿ç”¨äº†redux-thunkæ‰èƒ½è®©å®ƒå¾—ä»¥ä¸ºæ‰€æ¬²ä¸ºğŸ˜¤ï¼‰<br/>
<br/>ğŸ±è¿™ä¸ªè‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°è‡ªå·±å°±å¯ä»¥æ¥æ”¶ä¸€ä¸ªdispatchä¸ºå‚æ•°çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨actioncreatorä¸­çš„dispatchï¼Œç„¶åç»§ç»­æ´¾å‘actionæ”¹å˜storeå†…æ•°æ®ã€‚



```javascript

//index.js(storeæ–‡ä»¶å¤¹ä¸­)
//ä½¿ç”¨ä¸­é—´ä»¶çš„å®˜æ–¹é…ç½®

import {createStore,applyMiddleware,compose} from "redux";
import reducer from "./reducer";
import thunk from "redux-thunk";

const composeEnhancers =
  typeof window === 'object' &&
  window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ?   
    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({
    }) : compose;

const enhancer = composeEnhancers(
        applyMiddleware(thunk),
      );
      const store = createStore(reducer, enhancer);

export  default store;


//todolist.jsxä¸­çš„ä»£ç 

import React, { Component } from 'react';
import "./style.css";
import 'antd/dist/antd.css';
import store from "./store";
import * as actions from "./store/actionCreator";
import TodoListUi from "./todolistUI";
class Todolist extends Component {
    constructor (props){
        super(props);
        this.state=store.getState();
        this.handleInputChange=this.handleInputChange.bind(this);
        this.handleStoreChange=this.handleStoreChange.bind(this);
        this.handleBtnClick=this.handleBtnClick.bind(this);
        this.handleDeleteItem=this.handleDeleteItem.bind(this);
        store.subscribe(this.handleStoreChange);
    }
    //ç”Ÿå‘½å‘¨æœŸå‡½æ•°
    componentDidMount(){
        // axios.get("./api/list.json").then((res)=>{
        //     const data=res.data;
        //     const action=actions.getInitStateAction(data);
        //     store.dispatch(action);
        // })
        const action=actions.getDataAction();
        store.dispatch(action);
    }
    //æ´¾å‘acitonçš„å‡½æ•°
    // handleInputChange(e){
    //     const action=actions.handleInputChangeAction(e.target.value);
    //     store.dispatch(action);
    // }
    // //æ´¾å‘å¢åŠ todolistçš„action
    // handleBtnClick(){
    //     const action=actions.handleBtnClickAction();
    //     store.dispatch(action);
    // }
    // //æ´¾å‘åˆ é™¤itemé¡¹çš„action
    // handleDeleteItem(index){
    //     const action=actions.handleDeleteItemAction();
    //     store.dispatch(action);
    // }
    // //ç›‘å¬storeå†…æ•°æ®å˜åŒ–çš„æ—¶å€™
    // handleStoreChange(){
    //     this.setState(store.getState());
    // }
    // render() { 
    //     return (
    //         <TodoListUi 
    //         inputValue={this.state.inputValue}
    //         handleInputChange={this.handleInputChange}
    //         handleDeleteItem={this.handleDeleteItem}
    //         handleBtnClick={this.handleBtnClick}
    //         list={this.state.list}
    //         />
    //         )
    // }
}
export default Todolist;

//actionCreator.js

import  {CHANGE_INPUT_VALUE,ADD_TODO_ITEM,HANDLE_DELETE_ITEM,GET_INIT_STATE} from "./actionTypes";
import axios from "axios";
// export const handleInputChangeAction=(value)=>{
//     return{
//         type:CHANGE_INPUT_VALUE,
//         value
//     }
// }
// export const handleBtnClickAction=()=>{
//     return{
//         type:ADD_TODO_ITEM
//     }
// }
// export const handleDeleteItemAction=(index)=>{
//     return{
//         type:HANDLE_DELETE_ITEM,
//         index
//     }
// }
export const getInitStateAction=(data)=>{
    return{
        type:GET_INIT_STATE,
        data
    }
}
export const getDataAction=()=>{
    return (dispatch)=>{
        axios.get("./api/list.json").then((res)=>{
            const data=res.data;
            const action=getInitStateAction(data);
            dispatch(action);
        })
    }
}

```