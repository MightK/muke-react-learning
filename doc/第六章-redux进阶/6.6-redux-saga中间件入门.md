## 6.6ã€6.7 redux-saga ä¸­é—´ä»¶å…¥é—¨

```javascript
//uiå±‚æ´¾å‘acitonçš„å†…å®¹æ­£å¸¸åšæ´¾å‘ã€‚


//storeé‡Œé¢çš„é…ç½®é¡¹
import {createStore,applyMiddleware,compose} from "redux";
import reducer from "./reducer";
import thunk from "redux-thunk";
import createSagaMiddleware from 'redux-saga';//å¼•å…¥åˆ›å»ºsagaä¸­é—´ä»¶çš„æ–¹æ³•ï¼›
import MySaga from "./sagas";//å¼•å…¥sagaæ–‡ä»¶

const sagaMiddleware=createSagaMiddleware();//åˆ›å»ºä¸€ä¸ªsagamiddlewareä¸­é—´ä»¶

const composeEnhancers =
  typeof window === 'object' &&
  window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ?   
    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({
    }) : compose;

const enhancer = composeEnhancers(
        applyMiddleware(sagaMiddleware),//é€šè¿‡applymiddlewareä¸­é—´ä»¶å»ä½¿ç”¨è¿™ä¸ªä¸­é—´ä»¶
      );
      const store = createStore(reducer, enhancer);
      sagaMiddleware.run(MySaga);//é€šè¿‡sagamiddlewareä¸­é—´ä»¶å»è¿è¡Œmysagaæ–‡ä»¶ã€‚
export  default store;


//Mysaga.js   ä¸€å®šè¦å¯¼å‡ºä¸€ä¸ªgeneratorå‡½æ•°
import {takeEvery,put} from "redux-saga/effects";
import {GET_SAGA} from "./actionTypes";
import * as actions from "./actionCreator";
import axios from "axios";

function* getSaga(){
    console.log("NBA");
    try{
        const res= yield axios.get("./api/list.json");
        const action=actions.getInitStateAction(res.data);
        console.log(action);
        yield put(action);//æ´¾å‘action
    }catch(e){
        console.log("happyending")
    }

};
function* mySaga() {
    yield takeEvery(GET_SAGA, getSaga);//è¿™ä¸ªå›è°ƒå‡½æ•°å¯ä»¥æ˜¯ä¸€ä¸ªgeneratorå‡½æ•°æˆ–è€…æ™®é€šçš„å‡½æ•°
    //é€šè¿‡takeEveryå»æ•è·æ¯ä¸€æ¬¡æ´¾å‘å‡ºæ¥çš„actionï¼Œå¦‚æœè¿™ä¸ªactiontypeç­‰äºGET_SAGAï¼Œé‚£ä¹ˆå°±æ‰§è¡ŒgetSagaæ–¹æ³•
  }
  export default mySaga;
```

redux-sagaï¼š
1--é…ç½®å®Œäº†åï¼Œé¦–å…ˆé€šè¿‡createSagaMiddlelewareå»åˆ›å»ºä¸€ä¸ªsagamiddlewareï¼›
ç„¶åé€šè¿‡applyMiddlewareå»ä½¿ç”¨åˆ›å»ºå‡ºæ¥çš„sagamiddlewareï¼›<br>
2--saga.jsé‡Œé¢ä¸€å®šè¦å¯¼å‡ºä¸€ä¸ªgeneratorå‡½æ•°ï¼Œé‡Œé¢é€šè¿‡ä½¿ç”¨takeEveryæ–¹æ³•æŠ“å–æŒ‡å®šçš„actionTypeåæ‰§è¡Œç›¸åº”çš„æ–¹æ³•ï¼Œæœ€å¥½è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ä¸€ä¸ªgeneratorå‡½æ•°ï¼Œç„¶åå¾—åˆ°ç›¸åº”çš„æ•°æ®ï¼›<br>ä¹‹åæŠŠå–æ¥çš„æ•°æ®ç»“æœå†åˆ›å»ºä¸€ä¸ªactioné€šè¿‡putæ´¾å‘ç»™storeï¼Œstoreæ¥æ”¶åˆ°actionååˆç»™äº†reducerï¼Œåœ¨reducerä¸­è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚

ç†è§£ï¼šæªç»„è£…å¥½äº†ï¼Œè¦æƒ³ä½¿ç”¨è¿˜å¾—è£…å­å¼¹ï¼Œè€Œæˆ‘ä»¬è‡ªå·±å†™çš„saga.jså°±å¥½æ¯”æªé‡Œçš„å­å¼¹ï¼Œæªè¦æƒ³ä½¿ç”¨è¿˜å¾—å®‰å­å¼¹ğŸš„
